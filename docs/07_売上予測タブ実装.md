# 07_売上予測タブ実装

**Phase**: Phase 3 (Week 2-3)

## 概要
`app.py` の売上予測タブにUI、予測実行ロジック、結果の可視化を実装します。

## タスク
- [×] 予測設定UIセクション
  - [×] 予測期間選択（`st.selectbox`）
    - [×] 翌月（30日）
    - [×] 3ヶ月（90日）
    - [×] 半年（180日）
    - [×] 1年（365日）
  - [×] 詳細設定（折りたたみ可能: `st.expander`）
    - [×] 訓練/テスト分割比率（`st.slider`）
  - [×] 「予測を実行」ボタン（primary type）
- [×] 予測実行処理
  - [×] データ前処理（`SalesPredictor.prepare_data`）
  - [×] 訓練/テスト分割（`train_test_split_temporal`）
  - [×] モデル訓練（`st.spinner` でローディング表示）
  - [×] 将来予測実行
  - [×] 結果をセッションステートに保存
  - [×] エラーハンドリング（try-except with traceback）
- [×] 精度評価セクション
  - [×] 3カラムレイアウト
  - [×] RMSEメトリック表示（`st.metric`）
  - [×] MAEメトリック表示（`st.metric`）
  - [×] R²スコア表示（`st.metric` with delta）
- [×] 予測結果グラフ
  - [×] 実績データ＋予測データの折れ線グラフ（go.Figure）
  - [×] 訓練データ（青）、テストデータ（緑）、テスト予測（オレンジ点線）、将来予測（紫破線）で色分け
  - [×] 4つのトレース表示
  - [×] ホバーモード統一
- [×] 予測データ表示
  - [×] 予測結果テーブル（日付、予測売上）
  - [×] Excelダウンロードボタン
- [×] 所見コメント自動生成
  - [×] 予測トレンド（上昇/下降/横ばい）
  - [×] 精度評価コメント（R²スコアに基づく3段階）
  - [×] 注意事項（過去データベース、市場変化非反映、再訓練推奨）

## 実装メモ
- 予測実行は時間がかかる可能性があるため `st.spinner` 必須
- 予測グラフの実装例:
  ```python
  fig = go.Figure()
  fig.add_trace(go.Scatter(x=df['date'], y=df['actual'], name='実績', line=dict(color='blue')))
  fig.add_trace(go.Scatter(x=pred_df['date'], y=pred_df['predicted'], name='予測', line=dict(color='purple', dash='dash')))
  ```
